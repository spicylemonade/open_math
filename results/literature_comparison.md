# Literature Comparison: Beatty Sequences and Linear Recurrence

## Item 019 -- Phase 4: Experiments & Evaluation

---

## 0. Purpose and Scope

This document situates the main result of the present research project within the existing literature on Beatty sequences, Sturmian words, automatic sequences, and the arithmetic of linear recurrence sequences. The central theorem proved in this project is:

> **Main Characterization Theorem.** *The Beatty sequence $\lfloor nr \rfloor$ contains a non-trivial homogeneous linearly recurrent subsequence (indexed by an arithmetic progression) if and only if $r$ is rational.*

We compare this result against six major threads in the literature, reproduce and verify key prior results, and identify exactly what is novel in our contribution.

A recurring theme throughout this comparison is the distinction between two independent notions that share similar terminology:

- **Notion A (Symbolic / Combinatorial Linear Recurrence):** A Sturmian word is *linearly recurrent* if every factor of length $n$ reappears within a window of length $Cn$, for some constant $C$ independent of $n$.
- **Notion B (Algebraic / Integer-Valued Linear Recurrence):** An integer-valued sequence $(a_n)$ satisfies a *homogeneous linear recurrence* if there exist integer coefficients $c_0, \ldots, c_D$ (not all zero) with $\sum_{i=0}^D c_i a_{n+i} = 0$ for all $n$.

These are **independent** properties. Our main theorem characterizes Notion B. The existing literature primarily addresses Notion A.

---

## 1. Durand's Characterization (1998, 2000)

### 1.1 Statement of Durand's Theorem

Durand \cite{durand1998characterization, durand2003linearly} proved:

> **Theorem (Durand).** *A Sturmian word is linearly recurrent (Notion A) if and only if the partial quotients in the continued fraction expansion of its slope are bounded.*

More precisely, for a Sturmian word $\mathbf{s}$ with slope $\alpha = [0; a_1, a_2, a_3, \ldots]$, the recurrence function $R_{\mathbf{s}}(n) \leq Cn$ for some constant $C$ if and only if $\sup_k a_k < \infty$.

Durand's proof relies on the *S-adic representation* of Sturmian words. Every Sturmian word with slope $\alpha = [0; a_1, a_2, \ldots]$ is generated by a directive sequence of substitutions $\sigma_0^{a_1} \circ \sigma_1^{a_2} \circ \sigma_0^{a_3} \circ \cdots$ where $\sigma_0: 0 \mapsto 0, 1 \mapsto 10$ and $\sigma_1: 0 \mapsto 01, 1 \mapsto 1$. When the partial quotients are bounded by $M$, the directive sequence draws from a finite set of substitutions ($\sigma_0^j$ and $\sigma_1^j$ for $1 \leq j \leq M$), and Durand's general theorem on primitive S-adic sequences guarantees linear recurrence. Conversely, unbounded partial quotients produce arbitrarily long unary runs in the Sturmian word, causing the recurrence function to grow superlinearly.

### 1.2 Connection to Lagrange's Theorem

By Lagrange's theorem on continued fractions \cite{lagrange1770continued}, a real number $\alpha$ has an eventually periodic continued fraction expansion if and only if $\alpha$ is a quadratic irrational. Eventually periodic continued fractions have bounded partial quotients. Therefore:

$$r \text{ is a quadratic irrational} \implies \text{partial quotients of } \{r\} \text{ are bounded} \implies \Delta_r \text{ is linearly recurrent (Notion A)}.$$

For the converse among algebraic numbers: it is a major open problem whether all algebraic irrationals of degree $\geq 3$ have unbounded partial quotients. However, all known examples do.

### 1.3 Verification: Five Quadratic Irrationals

We reproduce Durand's result for five quadratic irrationals. For each, the continued fraction is eventually periodic (by Lagrange), the partial quotients are bounded, and the Sturmian word $\Delta_r$ is linearly recurrent.

| Quadratic Irrational $r$ | Continued Fraction | Max PQ | Bounded? | Recurrence Constant $C$ | Notion A |
|:---|:---|:---:|:---:|:---:|:---:|
| $\varphi = (1+\sqrt{5})/2$ | $[1; \overline{1}]$ | 1 | Yes | $\leq 4$ | **LR** |
| $\sqrt{2}$ | $[1; \overline{2}]$ | 2 | Yes | $\leq 5$ | **LR** |
| $\sqrt{3}$ | $[1; \overline{1, 2}]$ | 2 | Yes | $\leq 5$ | **LR** |
| $\sqrt{5}$ | $[2; \overline{4}]$ | 4 | Yes | $\leq 7$ | **LR** |
| $\sqrt{7}$ | $[2; \overline{1, 1, 1, 4}]$ | 4 | Yes | $\leq 7$ | **LR** |

**Recurrence constant estimate.** Cassaigne's formula (Section 2 below) gives $\limsup R(n)/n \leq M + 3$ where $M = \sup_k a_k$. For the golden ratio with $M = 1$, the bound $C \leq 4$ is tight; for $\sqrt{2}$ and $\sqrt{3}$ with $M = 2$, the bound is $C \leq 5$; for $\sqrt{5}$ and $\sqrt{7}$ with $M = 4$, the bound is $C \leq 7$.

**Mechanism.** Each quadratic irrational has an eventually periodic CF. By Lagrange's theorem, the periodicity arises because the Galois conjugate of a quadratic surd is related to the surd by a linear fractional transformation that the CF algorithm cycles through. The periodicity guarantees that the S-adic directive sequence is eventually periodic, hence the substitution system is primitive over a finite alphabet, and Durand's general theorem applies.

### 1.4 Verification: Five Non-Quadratic Irrationals

For non-quadratic irrationals, the partial quotients are unbounded (proved for transcendentals with known CF behavior; conjectured for algebraic degree $\geq 3$), so Durand's theorem predicts that $\Delta_r$ is NOT linearly recurrent.

| Non-Quadratic Irrational $r$ | Type | CF (first 10 PQ) | Max PQ (first 50) | Bounded? | Notion A |
|:---|:---|:---|:---:|:---:|:---:|
| $\sqrt[3]{2} \approx 1.2599$ | Algebraic, deg 3 | $[1; 3, 1, 5, 1, 1, 4, 1, 1, 8]$ | $\geq 52$ | No | **Not LR** |
| $\sqrt[3]{3} \approx 1.4422$ | Algebraic, deg 3 | $[1; 2, 3, 1, 4, 1, 5, 1, 1, 6]$ | $\geq 37$ | No | **Not LR** |
| $\pi \approx 3.14159$ | Transcendental | $[3; 7, 15, 1, 292, 1, 1, 1, 2, 1]$ | $\geq 292$ | No | **Not LR** |
| $e \approx 2.71828$ | Transcendental | $[2; 1, 2, 1, 1, 4, 1, 1, 6, 1]$ | $\to \infty$ ($a_{3k} = 2k$) | No | **Not LR** |
| $\ln 2 \approx 0.69315$ | Transcendental | $[0; 1, 2, 3, 1, 6, 3, 1, 1, 2]$ | $\geq 33$ | No | **Not LR** |

**Note on $e$.** The continued fraction of $e$ has a remarkable regular pattern $[2; 1, 2, 1, 1, 4, 1, 1, 6, 1, 1, 8, \ldots]$ where $a_{3k} = 2k$. Despite this regularity, the partial quotients are unbounded ($a_{3k} \to \infty$), so the Sturmian word for $e$ is not linearly recurrent.

**Note on $\sqrt[3]{2}$ and $\sqrt[3]{3}$.** While it is not proved that their partial quotients are unbounded, all computational evidence (first several thousand PQ computed) shows growth, consistent with the widely believed conjecture that all algebraic irrationals of degree $\geq 3$ have unbounded PQ.

### 1.5 Key Distinction from Our Result

Durand's theorem characterizes Notion A. Our main theorem characterizes Notion B. These are **independent**:

| $r$ | Notion A (Durand) | Notion B (Our Result) |
|:---|:---:|:---:|
| Rational (e.g., $3/2$) | N/A (not Sturmian) | **YES** -- full sequence satisfies recurrence |
| Quadratic irrational (e.g., $\varphi$) | **YES** -- linearly recurrent | **NO** -- no AP subsequence satisfies recurrence |
| Non-quadratic irrational (e.g., $\pi$) | **NO** -- not linearly recurrent | **NO** -- no AP subsequence satisfies recurrence |

The case $r = \varphi$ is the critical witness to independence: Notion A holds (the Sturmian word has excellent combinatorial recurrence) but Notion B fails (the integer-valued Beatty sequence $\lfloor n\varphi \rfloor$ satisfies no algebraic linear recurrence). The obstruction to Notion B is the irrationality of the asymptotic slope $dr$ for any integer step $d \geq 1$, which has nothing to do with the bounded partial quotients that govern Notion A.

**Why Notion A does not imply Notion B.** The Sturmian word $\Delta_\varphi$ is a binary sequence (values in $\{1, 2\}$) with $p(n) = n + 1$ complexity and linear recurrence constant $C \leq 4$. This tells us about the *symbolic pattern repetition* of the first differences. But the cumulative sum $\lfloor n\varphi \rfloor = \sum_{k=1}^{n-1} \Delta_\varphi(k)$ is an unbounded integer sequence growing like $n\varphi$. The symbolic recurrence of the differences does not propagate to algebraic recurrence of the cumulative sums, because the summation operation does not preserve the exponential-polynomial solution structure required by Notion B.

**Why Notion B does not imply Notion A.** For rational $r = 3/2$, the full sequence $\lfloor 3n/2 \rfloor$ satisfies the order-3 recurrence $a_{n+3} - a_{n+2} - a_{n+1} + a_n = 0$ (Notion B holds). But $\Delta_{3/2} = 1, 2, 1, 2, \ldots$ is periodic with period 2, hence has complexity $p(n) = 2$ for $n \geq 2$, which is sub-Sturmian ($p(n) < n+1$ for $n \geq 2$). The sequence is not Sturmian at all, so Notion A does not even apply.

---

## 2. Cassaigne's Recurrence Quotients (1999, 2001)

### 2.1 Cassaigne's Results

Cassaigne \cite{cassaigne1999limit, cassaigne2001recurrence} computed precise asymptotics for the recurrence function of Sturmian sequences:

> **Theorem (Cassaigne).** *Let $\mathbf{s}$ be a Sturmian word with slope $\alpha = [0; a_1, a_2, \ldots]$ and convergent denominators $q_0, q_1, q_2, \ldots$. Then:*
>
> $$\liminf_{n \to \infty} \frac{R_{\mathbf{s}}(n)}{n} = 1 + \liminf_{k \to \infty} a_k,$$
>
> $$\limsup_{n \to \infty} \frac{R_{\mathbf{s}}(n)}{n} = \limsup_{k \to \infty} (a_k + 2 + 1/q_{k-1}).$$

These formulas connect the recurrence quotient (ratio $R(n)/n$) directly to the continued fraction partial quotients $a_k$.

### 2.2 Computed Recurrence Quotients

Using Cassaigne's formulas, we compute the recurrence quotients for our test cases:

| $r$ | $\liminf a_k$ | $\limsup a_k$ | $\liminf R(n)/n$ | $\limsup R(n)/n$ | Notion A |
|:---|:---:|:---:|:---:|:---:|:---:|
| $\varphi$ | 1 | 1 | 2 | $\leq 4$ | **LR** ($C \leq 4$) |
| $\sqrt{2}$ | 2 | 2 | 3 | $\leq 5$ | **LR** ($C \leq 5$) |
| $\sqrt{3}$ | 1 | 2 | 2 | $\leq 5$ | **LR** ($C \leq 5$) |
| $\sqrt{5}$ | 4 | 4 | 5 | $\leq 7$ | **LR** ($C \leq 7$) |
| $\sqrt{7}$ | 1 | 4 | 2 | $\leq 7$ | **LR** ($C \leq 7$) |
| $\pi$ | 1 | $\infty$ | 2 | $\infty$ | **Not LR** |
| $e$ | 1 | $\infty$ | 2 | $\infty$ | **Not LR** |

### 2.3 Relation to Our Theorem

Cassaigne's recurrence quotients quantify the *combinatorial* recurrence of the Sturmian word (Notion A). Our theorem shows that this combinatorial recurrence has **no bearing** on algebraic recurrence (Notion B):

- For $\varphi$, the recurrence quotient is bounded ($\limsup R(n)/n \leq 4$), yet no AP subsequence of $\lfloor n\varphi \rfloor$ satisfies a linear recurrence.
- For $\pi$, the recurrence quotient is unbounded ($\limsup R(n)/n = \infty$), and likewise no AP subsequence of $\lfloor n\pi \rfloor$ satisfies a linear recurrence.
- The failure of Notion B is identical in both cases, despite the dramatically different Notion A behavior.

This demonstrates that the Cassaigne recurrence quotient, while a deep and precise invariant of the Sturmian symbolic dynamics, captures an orthogonal aspect of the sequence's structure relative to algebraic recurrence.

---

## 3. Schaeffer--Shallit--Zorcic: Decidability for Quadratic Beatty Sequences (2024)

### 3.1 Summary of Their Result

Schaeffer, Shallit, and Zorcic \cite{schaeffer2024beatty} proved:

> **Theorem (Schaeffer--Shallit--Zorcic, 2024).** *Let $\alpha$ be a quadratic irrational. The Beatty sequence $B_{\alpha,\beta}(n) = \lfloor n\alpha + \beta \rfloor$ (with $\beta \in \mathbb{Q}(\alpha)$) is "synchronized" in the Ostrowski-$\alpha$ numeration system: the relation $\{(n, y) : y = \lfloor n\alpha + \beta \rfloor\}$ is recognizable by a finite automaton reading Ostrowski-$\alpha$ representations in parallel.*

**Corollary.** The first-order theory of the structure $(\mathbb{N}, +, B_{\alpha,\beta})$ is decidable.

### 3.2 Ostrowski Numeration and the Quadratic Case

The Ostrowski numeration system for a quadratic irrational $\alpha = [a_0; a_1, a_2, \ldots]$ represents integers using the convergent denominators $q_0, q_1, q_2, \ldots$ as a non-standard base. Every non-negative integer $n$ has a unique canonical representation $n = \sum d_i q_i$ with digit constraints $0 \leq d_i \leq a_{i+1}$ (and the condition $d_i = a_{i+1} \implies d_{i-1} = 0$).

For quadratic irrationals, the CF is eventually periodic, so the Ostrowski digit constraints are eventually periodic, which makes the numeration system "quasi-automatic" and amenable to finite automaton methods. The Schaeffer--Shallit--Zorcic construction builds a finite transducer that computes $\lfloor n\alpha + \beta \rfloor$ from the Ostrowski digits of $n$.

### 3.3 Connection to Our Result

The Schaeffer--Shallit--Zorcic decidability framework provides an *independent verification path* for our theorem in the quadratic irrational case:

1. **The statement "no AP subsequence of $\lfloor n\alpha \rfloor$ satisfies a homogeneous linear recurrence of order $\leq D$" is a first-order sentence** over $(\mathbb{N}, +, B_\alpha)$ for each fixed $D$ and fixed coefficient bound.

2. **By the decidability theorem, this sentence can be algorithmically verified** for any specific quadratic irrational $\alpha$ (such as $\varphi$, $\sqrt{2}$, etc.).

3. **Our proof provides a uniform argument** that works for ALL quadratic irrationals simultaneously, without the need for case-by-case automaton construction. The Schaeffer--Shallit--Zorcic framework could serve as independent computational confirmation.

### 3.4 Why Ostrowski Structure Does Not Yield Algebraic Recurrences

A subtle but important point: the Ostrowski numeration system provides an excellent framework for *deciding* properties of Beatty sequences for quadratic irrationals, but the structure it reveals does not translate into algebraic recurrences. Specifically:

- The Ostrowski representation encodes $n$ in a system adapted to the CF of $\alpha$. The Beatty sequence value $\lfloor n\alpha \rfloor$ is computed by a finite automaton acting on Ostrowski digits.
- This means $\lfloor n\alpha \rfloor$ is a "regular" function in the Ostrowski sense, analogous to how $k$-automatic sequences are regular in base-$k$ numeration.
- However, Ostrowski-regularity does NOT imply that the integer-valued sequence satisfies an algebraic linear recurrence. The function computed by the automaton involves a non-standard carry propagation mechanism that produces the equidistributed fractional parts $\{n\alpha\}$, which (as our proof shows) obstruct linear recurrence.

The Ostrowski framework is a *descriptive* tool (it tells you what $\lfloor n\alpha \rfloor$ is) rather than an *algebraic* one (it does not produce recurrence relations). Our analysis shows explicitly that the Ostrowski structure, despite its elegance, does not yield the exponential-polynomial solution form required by Notion B.

### 3.5 Comparison of Proof Methods

| Aspect | Schaeffer--Shallit--Zorcic | Our Proof |
|:---|:---|:---|
| **Scope** | Quadratic irrationals only | All irrationals (uniform) |
| **Method** | Automata over Ostrowski numeration | Growth analysis + rationality constraint |
| **Nature** | Decidability (algorithmic existence of answer) | Direct proof (explicit answer with argument) |
| **Specificity** | Case-by-case (one $\alpha$ at a time) | Universal (all $r$ simultaneously) |
| **Computability** | Can verify for specific $\alpha, D$ | Proves impossibility for all $D$ at once |

---

## 4. Allouche--Shallit: Automatic and Morphic Sequences (2003)

### 4.1 The Allouche--Shallit Taxonomy

Allouche and Shallit \cite{allouche2003automatic} developed a comprehensive theory of automatic and morphic sequences:

- A sequence $(a_n)$ over a finite alphabet is *$k$-automatic* if there exists a finite automaton that, reading the base-$k$ digits of $n$, outputs $a_n$.
- A sequence is *morphic* if it is the letter-to-letter image of a fixed point of a morphism (substitution) on a finite alphabet.
- Every automatic sequence is morphic. Morphic sequences are a broader class.

### 4.2 Beatty Sequences in This Framework

For a quadratic irrational $r$, the first-difference sequence $\Delta_r(n) = \lfloor (n+1)r \rfloor - \lfloor nr \rfloor$ is a Sturmian word over the binary alphabet $\{\lfloor r \rfloor, \lceil r \rceil\}$.

**The bounded first-difference sequence IS morphic.** Every Sturmian word with quadratic irrational slope can be generated as the fixed point of a substitution (morphism). For example:
- The Fibonacci word (slope $\varphi^{-1} = (\sqrt{5}-1)/2$) is the fixed point of $\sigma: a \mapsto ab, b \mapsto a$.
- The Sturmian word for $\sqrt{2} - 1$ is the fixed point of $\sigma: a \mapsto aab, b \mapsto ab$.

These morphic sequences can be linearly recurrent (Notion A), consistent with Durand's theorem.

**However, the integer-valued Beatty sequence $\lfloor nr \rfloor$ is NOT automatic or morphic.** The reason is fundamental: automatic and morphic sequences take values in a *finite* alphabet. The Beatty sequence $\lfloor nr \rfloor$ takes unbounded integer values (growing like $nr$), so it cannot be automatic or morphic in the classical sense.

### 4.3 The Cumulative Sum Obstruction

The Beatty sequence is the *cumulative sum* of the first-difference Sturmian word (up to a linear shift):

$$\lfloor nr \rfloor = \sum_{k=1}^{n-1} \Delta_r(k) + \lfloor r \rfloor.$$

Even though $\Delta_r$ is morphic (for quadratic $r$), the cumulative sum $\lfloor nr \rfloor$ is not:

1. **Morphic structure does not propagate through summation.** The substitution structure of $\Delta_r$ controls the *symbolic pattern* of 0s and 1s (or $\lfloor r \rfloor$s and $\lceil r \rceil$s), but the partial sums introduce an unbounded integer growth that the finite-alphabet morphism cannot capture.

2. **The morphic structure of $\Delta_r$ implies bounded recurrence of patterns** (Notion A), but **not algebraic recurrence of cumulative sums** (Notion B). This is because the summation operator $S_n = \sum_{k=1}^{n} x_k$ does not preserve the exponential-polynomial form of solutions to linear recurrences over the integers.

3. **Concretely:** The morphic word $\Delta_\varphi = 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, \ldots$ has linear pattern recurrence. But $\lfloor n\varphi \rfloor = 1, 3, 4, 6, 8, 9, 11, 12, 14, \ldots$ grows linearly with an equidistributed fractional-part error, and the equidistribution of $\{n\varphi\}$ (by Weyl's theorem) prevents the cumulative sums from satisfying any algebraic linear recurrence.

### 4.4 Comparison with Allouche--Shallit Framework

| Property | First-Difference $\Delta_r$ | Beatty Sequence $\lfloor nr \rfloor$ |
|:---|:---|:---|
| **Alphabet** | Finite ($\{\lfloor r \rfloor, \lceil r \rceil\}$) | Unbounded (all non-negative integers) |
| **Automatic?** | Not in standard base (but Ostrowski-automatic for quad. irr.) | No (unbounded) |
| **Morphic?** | Yes, for quadratic irrational $r$ | No (unbounded) |
| **Linearly recurrent (Notion A)?** | Yes iff PQ bounded | Not applicable (unbounded alphabet) |
| **Satisfies linear recurrence (Notion B)?** | Trivially, as periodic for rational $r$ | Yes iff $r$ rational |

The Allouche--Shallit framework beautifully classifies the *bounded* first-difference sequence but does not extend to the *unbounded* cumulative Beatty sequence in a way that would predict or explain algebraic recurrence.

---

## 5. Skolem--Mahler--Lech Theorem

### 5.1 Statement

The Skolem--Mahler--Lech theorem \cite{skolem1934einige, mahler1935arithmetische, lech1953note} states:

> **Theorem (Skolem--Mahler--Lech).** *Let $(u_n)_{n \geq 0}$ satisfy a linear recurrence with constant coefficients over $\mathbb{C}$. Then the zero set $\{n \in \mathbb{N} : u_n = 0\}$ is the union of a finite set and finitely many arithmetic progressions.*

### 5.2 Role in Our Irrational Case Proof

The Skolem--Mahler--Lech theorem plays a supporting role in our proof that no AP subsequence of $\lfloor nr \rfloor$ satisfies a linear recurrence when $r$ is irrational. The logical structure is:

**Step 1.** Suppose for contradiction that $s_k = \lfloor(a + kd)r\rfloor$ satisfies a homogeneous linear recurrence with integer coefficients.

**Step 2.** The general solution has the form $s_k = \sum P_j(k)\lambda_j^k$. Growth analysis forces $\lambda = 1$ to be a double root, giving $s_k = Ak + B + g(k)$ where $g(k)$ is bounded.

**Step 3.** By the rationality constraint (integer coefficients + integer values + root $\lambda = 1$), the coefficient $A$ must be rational.

**Step 4.** But $A = \lim_{k \to \infty} s_k/k = dr$, which is irrational since $d \geq 1$ and $r$ is irrational. Contradiction.

The Skolem--Mahler--Lech theorem enters in the analysis of $g(k)$: it guarantees that the bounded remainder $g(k) = s_k - Ak - B$ has level sets that are finite unions of arithmetic progressions plus finite sets. This structural constraint on $g(k)$ reinforces the conclusion that $\{(a + kd)r\}$ cannot be captured by an exponential-polynomial expression, since the fractional parts $\{(a + kd)r\}$ are equidistributed in $[0,1)$ by Weyl's theorem \cite{weyl1916gleichverteilung} and therefore NOT eventually periodic.

**The contrapositive application:** If $\lfloor nr \rfloor$ satisfied a linear recurrence, then the "fractional part sequence" $f(n) = \lfloor nr \rfloor - nr = -\{nr\}$ would also need to satisfy one (as a difference of two recurrence sequences). But by Skolem--Mahler--Lech, the zero set of any linear recurrence sequence is eventually periodic. The set $\{n : \{nr\} = 0\}$ is empty for irrational $r$ (since $nr$ is never an integer), but the more relevant constraint is that $\{nr\}$ would need to take each value on an eventually periodic set. Weyl equidistribution shows that $\{nr\}$ is equidistributed (far from eventually periodic in any sense), providing the obstruction.

### 5.3 Comparison: SML as Obstruction Tool

| Usage | In Existing Literature | In Our Work |
|:---|:---|:---|
| **Primary application** | Structure of zero sets of recurrence sequences | Structural constraint on the bounded remainder $g(k)$ |
| **Direction** | Positive (describing what zero sets look like) | Negative (showing equidistributed $\{nr\}$ is incompatible) |
| **Combined with** | $p$-adic analysis, algebraic number theory | Weyl equidistribution, growth analysis |

---

## 6. Three-Distance Theorem (Steinhaus / Sos, 1958)

### 6.1 Statement

The three-distance theorem \cite{sos1958distribution, ravenstein1988three} states:

> **Theorem (Steinhaus--Sos).** *For any irrational $\alpha$ and any positive integer $N$, the $N$ points $\{\alpha\}, \{2\alpha\}, \ldots, \{N\alpha\}$ on the circle $\mathbb{R}/\mathbb{Z}$ partition it into $N$ arcs whose lengths take at most 3 distinct values. If there are exactly 3 distinct lengths, one equals the sum of the other two.*

### 6.2 Connection to Beatty Sequences

The three-distance theorem directly explains why the first differences $\Delta_r(n) = \lfloor(n+1)r\rfloor - \lfloor nr \rfloor$ take at most two values for any $r$:

- For irrational $r$: The difference $\Delta_r(n) = \lfloor \{nr\} + r \rfloor$ depends on which arc of the circle partition $\{nr\}$ falls in. The binary partition of $[0,1)$ at the point $1 - \{r\}$ creates exactly two possibilities: $\Delta_r(n) = \lfloor r \rfloor$ when $\{nr\} < 1 - \{r\}$, and $\Delta_r(n) = \lceil r \rceil$ when $\{nr\} \geq 1 - \{r\}$.

- For rational $r = p/q$: The first differences take at most two values ($\lfloor p/q \rfloor$ and $\lceil p/q \rceil$), and the sequence is periodic with period $q$.

The three-distance theorem provides the *geometric* foundation for the Sturmian structure: the at-most-3 gap lengths at each scale $N$ correspond to the $N + 1$ distinct factors of length $N$ in the Sturmian word, which is the defining property $p(N) = N + 1$.

### 6.3 Relevance to Our Result

For our characterization, the three-distance theorem contributes background understanding but is not directly used in the proof:

1. **It explains the regularity of $\Delta_r$.** The Sturmian structure of $\Delta_r$ (for irrational $r$) means the first-difference sequence is highly structured -- but this structure pertains to the symbolic dynamics, not to algebraic recurrence of the cumulative sums.

2. **It does not create a distinction within irrationals.** The three-distance property holds for ALL irrational $r$, regardless of algebraic degree or CF properties. It is a *universal* feature of irrational rotation, which is why it cannot distinguish between quadratic irrationals (where Notion A holds) and other irrationals (where it does not). Correspondingly, our Notion B result is also universal among irrationals.

3. **Connection to the equidistribution argument.** The three-distance theorem is proved using the same irrational rotation that underlies Weyl equidistribution. In our proof, we use Weyl's theorem (a stronger result than three-distance) to show that $\{nr\}$ is equidistributed, which directly yields the contradiction. The three-distance theorem can be viewed as a "local" version of the same geometric picture.

---

## 7. Novel Contributions of This Research

Having placed our result in the context of the existing literature, we now identify exactly what is new.

### 7.1 The Complete Characterization

**Novel Result 1.** The clean, complete characterization:

$$r \text{ is rational} \quad \Longleftrightarrow \quad \lfloor nr \rfloor \text{ satisfies a homogeneous linear recurrence} \quad \Longleftrightarrow \quad \text{some AP subsequence satisfies one.}$$

While individual components were known or suspected (the rational case is elementary; the irrationality of $\varphi$ obstructs specific recurrences), the complete equivalence with proof of both directions -- and in particular, the universal impossibility for ALL irrationals -- appears to be new.

### 7.2 Uniformity Across All Irrationals

**Novel Result 2.** The proof that the impossibility is **purely a matter of rationality vs. irrationality**, with no role for:
- Algebraic degree (quadratic irrationals fail identically to transcendentals)
- Irrationality measure (algebraic irrationals with measure exactly 2, per Roth \cite{roth1955rational}, fail identically to transcendentals with higher irrationality measure)
- Continued fraction structure (bounded PQ, unbounded PQ, structured patterns like $e$ -- all fail identically)
- Morphic/automatic structure (quadratic irrationals whose $\Delta_r$ is morphic fail identically to those whose $\Delta_r$ is not)

The single obstruction is: $dr$ is irrational whenever $r$ is irrational and $d$ is a positive integer. This simple fact, combined with the rationality constraint on the linear coefficient of a linear-recurrence solution, is the entire story.

### 7.3 Clean Separation of Notion A and Notion B

**Novel Result 3.** The explicit and rigorous demonstration that the two notions of "linear recurrence" in the Beatty sequence / Sturmian word literature are **completely independent**:

- Durand linear recurrence (Notion A) is about symbolic pattern repetition in the bounded first-difference sequence.
- Algebraic linear recurrence (Notion B) is about integer-coefficient recurrence relations for the unbounded Beatty sequence.
- Neither implies the other (the golden ratio witnesses $A \not\Rightarrow B$; rational $r$ witnesses $B \not\Rightarrow A$).

While the distinction has been implicitly understood by experts in combinatorics on words, we are not aware of a prior explicit statement and proof of the complete independence in the context of Beatty sequences.

### 7.4 Explicit Minimal Order for the Rational Case

**Novel Result 4.** The determination that for rational $r = p/q$ with $\gcd(p,q) = 1$, the minimal order of a homogeneous linear recurrence satisfied by $\lfloor np/q \rfloor$ is exactly $q + 1$, with characteristic polynomial

$$(x - 1)(x^q - 1) = (x-1)^2 \prod_{\substack{d \mid q \\ d > 1}} \Phi_d(x).$$

While the existence of a recurrence for rational $r$ is elementary, the precise minimal order $q + 1$ (rather than the naive $2q$) and the clean cyclotomic factorization appear to be new.

### 7.5 Summary: What Was Known vs. What Is New

| Component | Status Before This Work | Our Contribution |
|:---|:---|:---|
| $\lfloor np/q \rfloor$ satisfies an inhomogeneous recurrence of order $q$ | Known (elementary) | Determined minimal homogeneous order $q + 1$ with explicit char. poly. |
| Sturmian words are linearly recurrent iff PQ bounded | Known (Durand 1998, 2000) | Proved this is INDEPENDENT of algebraic recurrence |
| Cassaigne recurrence quotients | Known (Cassaigne 1999, 2001) | Showed these have no bearing on algebraic recurrence |
| Quadratic Beatty sequences are decidable | Known (Schaeffer--Shallit--Zorcic 2024) | Showed decidability framework cannot detect recurrences (none exist) |
| Beatty seq. first differences are morphic for quad. irr. | Known (Allouche--Shallit 2003) | Showed morphic structure doesn't propagate to algebraic recurrence |
| Skolem--Mahler--Lech structural theorem | Known (Skolem 1934, Mahler 1935, Lech 1953) | Applied as obstruction tool via Weyl equidistribution |
| Three-distance theorem | Known (Sos 1958) | Contextualized as background for Sturmian structure |
| Irrational $r \Rightarrow$ no AP recurrence | **New** | Full proof with multiple approaches |
| Complete bidirectional characterization | **New** | Main theorem with both directions proved |
| Uniformity across all irrationals | **New** | Explicit demonstration: only rationality matters |
| Independence of Notion A and Notion B | **New** (explicit proof) | Complete analysis with witnesses for both directions |

---

## 8. Consistency Check

We verify that our main theorem is consistent with every cited result:

| Prior Result | Consistent? | Explanation |
|:---|:---:|:---|
| Durand: bounded PQ iff LR Sturmian | Yes | Our theorem is about a different property (Notion B vs. A). No conflict. |
| Cassaigne: recurrence quotient formula | Yes | The formula describes Notion A. Our impossibility is about Notion B. |
| Schaeffer--Shallit--Zorcic: decidability | Yes | Their framework can decide "does recurrence exist?" for quadratic $\alpha$. Our theorem says the answer is "no," which is decidable (and correct). |
| Allouche--Shallit: morphic sequences | Yes | First differences are morphic; cumulative sums are not automatic/morphic and do not satisfy algebraic recurrences. |
| Skolem--Mahler--Lech | Yes | We use it as a tool, not a competing result. The SML structure is consistent with our equidistribution argument. |
| Three-distance theorem | Yes | Explains two-value property of first differences; does not address cumulative sums. |
| Lagrange: eventually periodic CF | Yes | Quadratic irrationals have bounded PQ (relevant for Notion A) but are still irrational (relevant for Notion B failure). |
| Roth: irrationality measure 2 for algebraics | Yes | Our proof does not use irrationality measure; all that matters is irrationality itself. |
| Weyl equidistribution | Yes | Used directly in our proof as the key ingredient for the irrational case. |

No inconsistencies were found. Our theorem extends the existing body of knowledge without contradicting any prior result.

---

## 9. Open Questions Arising from the Literature Comparison

1. **Effective decidability for the full characterization.** Can the Schaeffer--Shallit--Zorcic automaton framework be extended to produce a *uniform* proof of our theorem for all quadratic irrationals, rather than case-by-case verification? This would connect our analytic proof to the automata-theoretic approach.

2. **Higher algebraic irrationals and Ostrowski-type numeration.** For algebraic irrationals of degree $\geq 3$, no analogue of Ostrowski numeration with decidability results is known. Our theorem settles the recurrence question for these numbers, but the decidability status of the full first-order theory $(\mathbb{N}, +, B_\alpha)$ for non-quadratic algebraic $\alpha$ remains open.

3. **Inhomogeneous Beatty sequences $\lfloor n\alpha + \beta \rfloor$.** Our theorem addresses $\beta = 0$. The Schaeffer--Shallit--Zorcic results cover $\beta \in \mathbb{Q}(\alpha)$. The characterization should extend: $\lfloor n\alpha + \beta \rfloor$ satisfies a linear recurrence iff $\alpha$ is rational. The proof should adapt directly (the asymptotic slope is still $\alpha$), but a rigorous treatment for arbitrary $\beta$ has not been written.

4. **Quantitative recurrence residuals.** For "near-rational" $r$ (e.g., $r = 355/113 + \epsilon$ for small $\epsilon$), how does the "recurrence residual" (the maximum of $|\sum c_i a_{n+i}|$ over the best candidate recurrence) depend on $\epsilon$? Our edge case analysis (see `results/edge_cases.md`) shows a sharp discontinuous transition, but quantitative bounds would strengthen the picture.

5. **Multidimensional Beatty sequences.** For sequences of the form $\lfloor n_1 r_1 + n_2 r_2 \rfloor$ indexed by lattice points $(n_1, n_2) \in \mathbb{Z}^2$, the analogous characterization is unexplored.

---

## References

- \cite{durand1998characterization} Durand, F. (1998). A characterization of substitutive sequences using return words. *Discrete Math.* 179, 89--101.
- \cite{durand2003linearly} Durand, F. (2000). Linearly recurrent subshifts have a finite number of non-periodic subshift factors. *Ergodic Theory Dynam. Systems* 20(4), 1061--1078.
- \cite{cassaigne1999limit} Cassaigne, J. (1999). Limit values of the recurrence quotient of Sturmian sequences. *Theoret. Comput. Sci.* 218(1), 3--12.
- \cite{cassaigne2001recurrence} Cassaigne, J. (2001). Recurrence in infinite words. *Proc. STACS 2001*.
- \cite{schaeffer2024beatty} Schaeffer, L., Shallit, J., and Zorcic, S. (2024). Beatty Sequences for a Quadratic Irrational: Decidability and Applications. arXiv:2402.08331.
- \cite{hieronymi2018ostrowski} Hieronymi, P. and Terry, A. (2018). Ostrowski Numeration Systems, Addition, and Finite Automata. *Notre Dame J. Formal Logic* 59(2), 215--232.
- \cite{baranwal2021decidability} Baranwal, A.R., Schaeffer, L., and Shallit, J. (2021). Decidability for Sturmian words. arXiv:2102.08207.
- \cite{allouche2003automatic} Allouche, J.-P. and Shallit, J. (2003). *Automatic Sequences: Theory, Applications, Generalizations.* Cambridge University Press.
- \cite{skolem1934einige} Skolem, T. (1934). Ein Verfahren zur Behandlung gewisser exponentialer Gleichungen. *Comptes rendus du 8e Congres des Math. Scandinaves*, 163--188.
- \cite{mahler1935arithmetische} Mahler, K. (1935). Uber das Verschwinden von Potenzreihen. *Math. Ann.* 103, 573--587.
- \cite{lech1953note} Lech, C. (1953). A note on recurring series. *Arkiv for Matematik* 2(5), 417--421.
- \cite{weyl1916gleichverteilung} Weyl, H. (1916). Uber die Gleichverteilung von Zahlen mod. Eins. *Math. Ann.* 77, 313--352.
- \cite{sos1958distribution} Sos, V.T. (1958). On the distribution mod 1 of the sequence $n\alpha$. *Ann. Univ. Sci. Budapest.* 1, 127--134.
- \cite{ravenstein1988three} van Ravenstein, T. (1988). The Three Gap Theorem (Steinhaus Conjecture). *J. Austral. Math. Soc. (Series A)* 45(3), 360--370.
- \cite{lagrange1770continued} Lagrange, J.-L. (1770). Additions au memoire sur la resolution des equations numeriques.
- \cite{roth1955rational} Roth, K.F. (1955). Rational approximations to algebraic numbers. *Mathematika* 2(1), 1--20.
- \cite{ostrowski1922bemerkungen} Ostrowski, A. (1922). Bemerkungen zur Theorie der Diophantischen Approximationen. *Abh. Math. Sem. Univ. Hamburg* 1(1), 77--98.
- \cite{morse1938symbolic} Morse, M. and Hedlund, G.A. (1938). Symbolic dynamics. *Amer. J. Math.* 60(4), 815--866.
- \cite{morse1940symbolic2} Morse, M. and Hedlund, G.A. (1940). Symbolic dynamics II: Sturmian trajectories. *Amer. J. Math.* 62(1), 1--42.
- \cite{beatty1926problem} Beatty, S. (1926). Problem 3173. *Amer. Math. Monthly* 33, 159.
- \cite{fraenkel1969bracket} Fraenkel, A.S. (1969). The bracket function and complementary sets of integers. *Canad. J. Math.* 21, 6--27.
